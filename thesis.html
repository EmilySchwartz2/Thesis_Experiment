<!DOCTYPE html>
<html>

<head>
  <title>My experiment</title>
  <script src="https://unpkg.com/jspsych@8.2.2"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.1.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-image-keyboard-response@2.1.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-preload@2.1.0"></script>
  <script src="https://unpkg.com/@jspsych/plugin-survey-html-form@1.0.3"></script>
  <link href="https://unpkg.com/jspsych@8.2.2/css/jspsych.css" rel="stylesheet" type="text/css" />

  <link href="style.css" rel="stylesheet" type="text/css" />
</head>

<body></body>
<script>

  /* initialize jsPsych */
  var jsPsych = initJsPsych(
    { on_finish: () => /*jsPsych.data.displayData('csv')*/ jsPsych.data.get().localSave('csv', 'debug_data.csv') }
  );

  /* create timeline */
  var timeline = [];
// comment from bellow this line


  /* define welcome message trial */
  var welcome = {
    type: jsPsychSurveyHtmlForm,
    html: `
      <p>Welcome to the experiment.</p>`,
    button_label: "Continue",
  };
  timeline.push(welcome);

  /* define consent trial */
  var consent = {
    type: jsPsychSurveyHtmlForm,
    html: `
      <div class="consentFormDiv">
        <p><strong>Study Title:</strong> Make Your Choice! A Fast-And-Slow Decision Task</p>
        <p></p>
        <p><strong>Name and Contact Information of Researchers:</strong> Emily Schwartz, Carleton University, Department of Psychology</p>
        <p>Email: emilyschwartz@cmail.carleton.ca</p>
        <p></p>
        <p>Supervisor: Dr. Guy Lacroix, Carleton University, Department of Psychology</p>
        <p>Email: guylacroix@cunet.carleton.ca</p>
        <p></p>
        <p><strong>Carleton University Project Clearance</strong></p>
        <p><strong>Clearance #:</strong> #125129</p>
        <p><strong>Study Clearance Date:</strong></p>
        <p></p>
        <p><strong>Invitation:</strong> You are invited to take part in a research study
        titled "Make Your Choice! A Fast-And-Slow Decision Task". The information provided
        here is intended to help you understand what the study involves so that you can
        decide whether you want to participate. Your participation in this study is
        completely voluntary, and choosing not to participate will not affect you in any
        way. Please take your time to read this form carefully, and feel free to ask any
        questions before making your decision.<p>
        <p></p>
        <p><strong>What is the purpose of the study?</strong> This study aims to investigate
        the factors that influence decision-making. You will complete an online, computerized
        task where you will respond to a series of base-rate questions based on your first
        inclination. Additionally, you will complete three logic problems. This study will
        help researchers better understand the factors related to decision-making.</p>
        <p></p>
        <p><strong>What will I be asked to do?</strong> If you choose to participate,
        you will complete an online, computer-based decision-making task. During the task,
        you will be responding to a series of base-rate problems. In these problems,
        you will be presented with two possible groups that a certain Person A might
        belong to. You will be given a brief description of Person A, in addition to
        the number of people found in each of the two groups. You will then be asked
        to state which group you believe Person A belongs to, based on the information
        provided. You will be asked to make this decision within two seconds, based
        on your first inclination. Following these base-rate problems, you will be asked
        to complete three logic problems. The entire session, including instructions, the
        base-rate task, and the logic questions, is expected to take approximately 30 minutes.</p>
        <p></p>
        <p><strong>Risks and Inconveniences:</strong> There will be no more risks than you would
        otherwise encounter sitting in front of a computer for approxiimately 30 minutes. If at
        any point you feel discomfort, you may take breaks or withdraw from the study without penalty.</p>
        <p></p>
        <p><strong>Possible Benefits:</strong> You may not receive any direct benefit from your
        participation in this study. However, your participation may allow researchers to better
        understand the factors that guide decision-making.</p>
        <p></p>
        <p><strong>Compensation/Incentives:</strong> You will receive 0.5% course credit for
        participating in this study. If you choose to withdraw at any point, you will still receive
        the full credit.</p>
        <p></p>
        <p><strong>No waiver of your rights:</strong> By signing this form, you are not waiving any
        rights or releasing the researchers from any liability.</p>
        <p></p>
        <p><strong>Withdrawing from the study:</strong> You may withdraw consent at any time. If
        you choose to withdraw during the study, all information collected from you before your
        withdrawal will still be used. If you decide that you would like your data deleted, you may
        email the experimenters. This is possible up until the final day of the semester in which
        you participated. For the fall semester, the last day to withdraw is December 5th, 2025. For
        the winter semester, the last day to withdraw is April 8th, 2026.</p>
        <p></p>
        <p><strong>Confidentiality:</strong> We will remove all identifying information from downloaded
        data as soon as possible, which will be after the semester in which you take place. We will treat
        personal information as confidential, although absolute privacy cannot be guaranteed. No
        information that discloses your identity will be released or published without your specific consent.
        Research records may be accessed by the Carleton University Research Ethics Board to ensure 
        continuing ethics compliance. The results of this study may be published or presented at an academic
        conference or meeting, published in a manuscript, or otherwise shared with the academic community,
        but the data will be presented so that it will not be possible to identify any participants unless
        you give your express consent. Anonymized data will be shared publicly. The data may be used for secondary
        analyses (i.e., for purposes unrelated to this study). For the portion of the experiment taking part on
        Pavlovia, your data will be stored and protected by Pavlovia, in a server located in France, but may be
        disclosed via a court order or data breach.</p>
        <p></p>
        <p><strong>Data Retention:</strong> Data will be kept on a password protected server. Anonymized data will
        be made available on freely accessible websites (e.g., OSF) and shared with any interested parties.
        Anonymized data will be stored indefinitely.</p>
        <p></p>
        <p><strong>New information during the study:</strong> In the event that any changes could affect your
        decision to continue participating in this study, you will be promptly informed.</p>
        <p></p>
        <p><strong>Ethics review:</strong> This project was reviewed and cleared by the Carleton University
        Research Ethics Board B. If you have any ethical concerns with this study, please contact Carleton
        University Research Ethics Board (by phone at 613-520-2600 ext. 2517 or by email at ethics@carleton.ca).</p>
        <p></p>
        </div>
      `,
  };
  timeline.push(consent);

  // Consent form trial
  const consentForm = {
    type: jsPsychSurveyHtmlForm,
    preamble: `
        <p><strong>Statement of Consent</strong></p>
        <p>By entering your full name and checking the box, you agree to participate.</p>
      `,
    html: `
        <p>First Name / Last Name <input name="name" type="text" id="nameField" /></p>
        <p><label><input name="I_Consent" type="checkbox" id="consentBox" /> I consent</label></p>
      `,
    button_label: "Continue",

    on_load: function () {
      const nameField = document.getElementById('nameField');
      const consentBox = document.getElementById('consentBox');
      // const continueButton = document.querySelector('.jspsych-btn');
      const continueButton = document.getElementById('jspsych-survey-html-form-next');

      // Disable the button initially
      continueButton.disabled = true;

      // Enable the button only if both fields are valid
      function validate() {
        if (nameField.value.trim() !== "" && consentBox.checked) {
          continueButton.disabled = false;
        } else {
          continueButton.disabled = true;
        }
      }

      // Listen for input changes
      nameField.addEventListener('input', validate);
      consentBox.addEventListener('change', validate);
    }
  };

  timeline.push(consentForm);

  /* define first instructions trial */
  var instructions1 = {
    type: jsPsychSurveyHtmlForm,
    html: `
        <div style="max-width: 60vw;">
        <p><strong>Please read the following instructions carefully.</strong></p>
        <p></p>
        <p>In a big research project, a number of studies were carried out where short personality
        descriptions of the participants were made. In every study, there were participants from
        two population groups (e.g., carpenters and policemen).<br />In each study, one participant was
        drawn at random from the sample. You'll also get information on how many participants are in
        each population group. You'll be asked to indicate to which population group the participant
        most likely belongs.</p>
        <p></p>
        </div>
      `,
    button_label: "Continue",
  };
  timeline.push(instructions1);

  /* define second instructions trial */
  var instructions2 = {
    type: jsPsychSurveyHtmlForm,
    html: `
        <p>There are no right or wrong answers. <br/> 
        <strong>Please respond based on your first inclination</strong>. <br/>
        Do not spend too much time thinking about each decision.</p>
        <p></p>

      `,
    button_label: "Continue"
  };
  timeline.push(instructions2);
// comment out to this line


  /* experimental trials */
  /* exp. trial 1 */

  var fixation = {
    type: jsPsychHtmlKeyboardResponse,
    stimulus: '<div style="font-size:60px;">+</div>',
    choices: "NO_KEYS",
    trial_duration: 1000
  };
 


// simple base rate template
const baseRateTemplate = (text) => `
  <div class="baseRateDiv">
    <p>${text}</p>
  </div>
`;

// simple stereotype template
const stereotypeTemplate = (text) => `
  <div class="stereotypeDiv">
    <p>${text}</p>
  </div>
`;

// participant response with two options
const participantResponseTemplate = (option1, option2) => `
  <div style="font-size:30px;">
    <p>What is most likely?</p>
    <table class="participantResponseTable">
      <tr>
        <td class="option"><span>${option1}</span><br/></td>
        <td class="divider"></td>
        <td class="option"><span>${option2}</span><br/></td>
      </tr>
      <tr>
        <td><span class="participantResponseKeyNudge">(Click F)</span></td>
        <td></td>
        <td><span class="participantResponseKeyNudge">(Click J)</span></td>
      </tr>
    </table>
  </div>
`;
var baserate = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: function() {
    return baseRateTemplate(jsPsych.evaluateTimelineVariable('baseRateText'));
  },
  choices: "NO_KEYS",
  trial_duration: 5000
};

var stereotype = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: function() {
    return stereotypeTemplate(jsPsych.evaluateTimelineVariable('stereotypeText'));
  },
  choices: "NO_KEYS",
  trial_duration: 5000
};

// var participantResponse = {
//   type: jsPsychHtmlKeyboardResponse,
//   stimulus: function() {
//     return participantResponseTemplate(
//       jsPsych.evaluateTimelineVariable('option1'),
//       jsPsych.evaluateTimelineVariable('option2')
//     ) +
//     '<audio src="audio/650842__andreas__wrong-answer-buzzer.mp3" autoplay controls></audio>';
//   },
//   choices: ['f', 'j'],
//   data: { task: jsPsych.timelineVariable('dataName') }
  
// };

var participantResponse = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: function() {
    return participantResponseTemplate(
      jsPsych.evaluateTimelineVariable('option1'),
      jsPsych.evaluateTimelineVariable('option2')
    ) + `
      <audio id="warningbeeps"
            src="audio/2second_ding_buzz.mp3"
            class="audioPlayer"></audio>
    `;
  },
    on_load: function() {
    // Wait 1 seconds after the trial loads, then play
    setTimeout(() => {
      const audio = document.getElementById("warningbeeps");
      if (audio) audio.play();
    }, 1000);
  },
  choices: ['f', 'j'],
  trial_duration: 5000,
  data: { task: jsPsych.timelineVariable('dataName') }
};

const practiceprocedure = {
  timeline: [fixation, baserate, stereotype, participantResponse],
  timeline_variables: [
    /* start of question 1 */
    {
      dataName: "question1",
      baseRateText: `This study contains pool players and basketball players.<br/>There are 500 pool players and 500 basketball players.`,
      stereotypeText: `Jason is a randomly chosen participant in this study.<br/>He is 29 years old and has lived his whole life in New York.<br/>He has green eyes and black hair.<br/>He drives a light-gray car.`,
      option1: "Jason is a pool player",
      option2: "Jason is a basketball player",
    }, 
     /* end of question 1 */
     /* start of question 2 */
    {
      dataName: "question2",
      baseRateText: `This study contains people who live in New York and people who live in Los Angeles.<br/>There are 500 people who live in New York and 500 people who live in Los Angeles.`,
      stereotypeText: `Christopher is a randomly chosen participant of thi study.<br/>Christopher is 28 years old.<br/>He has a girlfriend and shares an apartment with a friend.<br/>He likes watching basketball.`,
      option1: "Christopher lives in New York",
      option2: "Christopher lives in Los Angeles",
    },
    /* end of question 2 */
    /* start of question 3 */
    {
      dataName: "question3",
      baseRateText: `This study contains computer science majors and English majors. There are 500 computer science majors and 500 English majors.`,
      stereotypeText: `Matt is a randomly chosen participant of this study. Mats is 20 years old and lives in downtown Toronto. Matt's favourite food is pasta with meatballs. His parents are living in Vancouver.`,
      option1: "Matt is a computer science major",
      option2: "Matt is an English major",
    },
  ]
};






  timeline.push(practiceprocedure);


  

  /* start the experiment */
  jsPsych.run(timeline);
  console.log(jsPsych.data.get())

</script>

</html>
